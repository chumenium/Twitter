# Twitter風SNSアプリケーション プロジェクト仕様書

## 1. プロジェクト概要

### 1.1 プロジェクト名
Twitter風SNSアプリケーション（MicroBoard）

### 1.2 プロジェクトの目的
- ユーザーが短い投稿（最大280文字）を共有できるSNSプラットフォームの構築
- 画像投稿、いいね、ブックマーク機能を備えたモダンなWebアプリケーション
- レスポンシブデザインによるマルチデバイス対応
- Django REST API + Reactフロントエンドの分離アーキテクチャ

### 1.3 技術スタック
#### バックエンド
- **フレームワーク**: Django 5.2.3
- **API**: Django REST Framework 3.14.0
- **認証**: Django標準認証システム
- **データベース**: SQLite（開発環境）
- **画像処理**: Pillow 11.2.1
- **CORS**: django-cors-headers 4.3.1
- **環境変数**: python-decouple 3.8

#### フロントエンド
- **フレームワーク**: React 19.1.0
- **言語**: TypeScript 4.9.5
- **ルーティング**: React Router DOM 7.6.3
- **HTTP通信**: Axios 1.10.0
- **ビルドツール**: React Scripts 5.0.1

## 2. システムアーキテクチャ

### 2.1 全体構成
```
┌─────────────────┐    HTTP/JSON    ┌─────────────────┐
│   React App     │ ←────────────→ │   Django API    │
│  (Port 3000)    │                 │  (Port 8001)    │
└─────────────────┘                 └─────────────────┘
                                              │
                                              ▼
                                    ┌─────────────────┐
                                    │   SQLite DB     │
                                    └─────────────────┘
```

### 2.2 ディレクトリ構造
```
project4/
├── backend/                    # Djangoアプリケーション
│   ├── models.py              # データモデル
│   ├── views.py               # ビュー（サーバーサイドレンダリング）
│   ├── api_views.py           # APIビュー
│   ├── serializers.py         # DRFシリアライザー
│   ├── auth_views.py          # 認証関連ビュー
│   ├── forms.py               # フォーム
│   ├── urls.py                # URL設定
│   ├── admin.py               # 管理画面設定
│   ├── signals.py             # シグナル
│   └── templates/             # テンプレート
├── frontend/                   # Reactアプリケーション
│   ├── src/
│   │   ├── components/        # Reactコンポーネント
│   │   ├── pages/            # ページコンポーネント
│   │   ├── api/              # API通信
│   │   ├── types/            # TypeScript型定義
│   │   ├── contexts/         # React Context
│   │   ├── hooks/            # カスタムフック
│   │   ├── utils/            # ユーティリティ
│   │   └── styles/           # スタイル
│   ├── public/               # 静的ファイル
│   └── package.json          # 依存関係
├── config/                    # Djangoプロジェクト設定
│   ├── settings.py           # 設定ファイル
│   └── urls.py               # メインURL設定
├── static/                    # 静的ファイル
├── manage.py                  # Django管理スクリプト
├── requirements.txt           # Python依存関係
└── README.md                  # プロジェクト説明
```

## 3. データモデル設計

### 3.1 User（Django標準）
```python
- id: AutoField (主キー)
- username: CharField (一意、ユーザー名)
- email: EmailField (メールアドレス)
- password: CharField (ハッシュ化されたパスワード)
- is_active: BooleanField (アカウント有効性)
- date_joined: DateTimeField (登録日時)
```

### 3.2 Profile（ユーザープロフィール）
```python
- user: OneToOneField (Userとの1対1関係)
- name: CharField (表示名、最大30文字)
- image: ImageField (プロフィール画像、オプション)
- bio: TextField (自己紹介文、オプション)
```

### 3.3 Post（投稿）
```python
- user: ForeignKey (投稿者、Userとの外部キー)
- content: TextField (投稿内容、最大280文字)
- image: ImageField (投稿画像、オプション)
- created_at: DateTimeField (投稿日時、自動設定)
```

### 3.4 Like（いいね）
```python
- user: ForeignKey (いいねしたユーザー)
- post: ForeignKey (いいねされた投稿)
- created_at: DateTimeField (いいね日時)
- Meta: unique_together ('user', 'post') # 重複防止
```

### 3.5 Bookmark（ブックマーク）
```python
- user: ForeignKey (ブックマークしたユーザー)
- post: ForeignKey (ブックマークされた投稿)
- created_at: DateTimeField (ブックマーク日時)
- Meta: unique_together ('user', 'post') # 重複防止
```

## 4. API仕様

### 4.1 認証API
| メソッド | エンドポイント | 説明 | リクエスト | レスポンス |
|---------|---------------|------|-----------|-----------|
| POST | `/api/auth/register/` | ユーザー登録 | username, email, password | ユーザー情報 |
| POST | `/api/auth/login/` | ユーザーログイン | username, password | トークン情報 |
| POST | `/api/auth/logout/` | ユーザーログアウト | - | 成功メッセージ |
| GET | `/api/auth/user/` | 現在のユーザー情報 | - | ユーザー情報 |
| PUT | `/api/auth/profile/` | プロフィール更新 | name, image, bio | プロフィール情報 |

### 4.2 投稿API
| メソッド | エンドポイント | 説明 | リクエスト | レスポンス |
|---------|---------------|------|-----------|-----------|
| GET | `/api/posts/` | 投稿一覧取得 | - | 投稿リスト |
| POST | `/api/posts/` | 新規投稿作成 | content, image | 投稿情報 |
| GET | `/api/posts/{id}/` | 投稿詳細取得 | - | 投稿詳細 |
| PUT | `/api/posts/{id}/` | 投稿更新 | content, image | 投稿情報 |
| DELETE | `/api/posts/{id}/` | 投稿削除 | - | 成功メッセージ |
| POST | `/api/posts/{id}/toggle_like/` | いいね切り替え | - | いいね状態 |
| POST | `/api/posts/{id}/toggle_bookmark/` | ブックマーク切り替え | - | ブックマーク状態 |

### 4.3 特殊エンドポイント
| メソッド | エンドポイント | 説明 |
|---------|---------------|------|
| GET | `/api/posts/timeline/` | タイムライン取得 |
| GET | `/api/posts/my_posts/` | 自分の投稿取得 |
| GET | `/api/posts/liked_posts/` | いいねした投稿取得 |
| GET | `/api/posts/bookmarked_posts/` | ブックマークした投稿取得 |

## 5. フロントエンド機能仕様

### 5.1 認証機能
#### 5.1.1 ユーザー登録
- **入力項目**: ユーザー名、メールアドレス、パスワード、パスワード確認
- **バリデーション**: 
  - ユーザー名の一意性チェック
  - パスワード8文字以上
  - メールアドレス形式チェック
- **エラーハンドリング**: 適切なエラーメッセージ表示

#### 5.1.2 ユーザーログイン
- **入力項目**: ユーザー名/メールアドレス、パスワード
- **認証方式**: セッションベース認証
- **リダイレクト**: ログイン成功後ホームページへ

#### 5.1.3 ユーザーログアウト
- **動作**: セッション終了
- **リダイレクト**: ログインページへ

### 5.2 投稿機能
#### 5.2.1 投稿作成
- **入力項目**: 投稿内容（最大280文字）、画像（オプション）
- **画像制限**: 5MB以下、JPG/PNG/GIF形式
- **リアルタイム文字数カウント**: 残り文字数表示

#### 5.2.2 投稿表示
- **表示項目**: ユーザー名、投稿内容、画像、投稿日時、いいね数、いいね状態、ブックマーク状態
- **ソート**: 投稿日時順（新しい順）
- **ページネーション**: 無限スクロール対応

#### 5.2.3 投稿編集・削除
- **権限**: 自分の投稿のみ
- **編集**: インライン編集対応
- **削除**: 確認ダイアログ表示

### 5.3 いいね機能
- **いいね追加**: 投稿へのいいね
- **いいね解除**: いいねの取り消し
- **いいね数表示**: リアルタイム更新
- **重複防止**: 同じ投稿への複数回いいね防止

### 5.4 ブックマーク機能
- **ブックマーク追加**: 投稿のブックマーク
- **ブックマーク解除**: ブックマークの取り消し
- **ブックマーク一覧**: 専用ページでの表示
- **重複防止**: 同じ投稿への複数回ブックマーク防止

### 5.5 プロフィール機能
#### 5.5.1 プロフィール表示
- **表示項目**: ユーザー名、表示名、プロフィール画像、自己紹介文、投稿数、いいね数、ブックマーク数

#### 5.5.2 プロフィール編集
- **編集項目**: 表示名、プロフィール画像、自己紹介文
- **画像アップロード**: ドラッグ&ドロップ対応

### 5.6 ナビゲーション機能
- **メニュー項目**: ホーム、マイページ、ブックマーク、設定、ログアウト
- **レスポンシブ**: モバイル対応ハンバーガーメニュー

## 6. 非機能要件

### 6.1 パフォーマンス要件
- **ページ読み込み時間**: 3秒以内
- **API応答時間**: 1秒以内
- **同時接続ユーザー数**: 100人以上
- **画像最適化**: 自動リサイズ・圧縮

### 6.2 セキュリティ要件
- **HTTPS通信**: 本番環境での必須化
- **CSRF対策**: Django標準CSRFトークン
- **SQLインジェクション対策**: ORM使用による自動対策
- **XSS対策**: 入力値の適切なエスケープ
- **認証情報管理**: セッション管理の適切な実装

### 6.3 ユーザビリティ要件
- **レスポンシブデザイン**: PC、タブレット、スマートフォン対応
- **直感的なUI/UX**: モダンなデザイン
- **アクセシビリティ**: WCAG準拠
- **エラーハンドリング**: 分かりやすいエラーメッセージ

### 6.4 保守性要件
- **コード品質**: TypeScriptによる型安全性
- **モジュール化**: コンポーネントベース設計
- **コメント**: 適切なドキュメント
- **テスト**: ユニットテスト・統合テスト

## 7. 開発環境設定

### 7.1 必要なソフトウェア
- **Node.js**: 18.0.0以上
- **npm**: 9.0.0以上
- **Python**: 3.8以上
- **pip**: 最新版

### 7.2 開発サーバー設定
- **バックエンド**: Django開発サーバー（ポート8001）
- **フロントエンド**: React開発サーバー（ポート3000）
- **CORS設定**: 開発環境でのクロスオリジン通信許可

### 7.3 環境変数設定
```bash
# .envファイル
DEBUG=True
SECRET_KEY=your-secret-key
ALLOWED_HOSTS=localhost,127.0.0.1
CORS_ALLOWED_ORIGINS=http://localhost:3000
```

## 8. デプロイメント

### 8.1 本番ビルド
```bash
# フロントエンドビルド
cd frontend
npm run build

# バックエンド設定
python manage.py collectstatic
python manage.py migrate
```

### 8.2 推奨本番環境
- **Webサーバー**: Nginx
- **アプリケーションサーバー**: Gunicorn
- **データベース**: PostgreSQL
- **静的ファイル**: AWS S3 / CloudFront

## 9. 今後の拡張予定

### 9.1 機能拡張
- **フォロー機能**: ユーザー間のフォロー関係
- **リツイート機能**: 投稿の再投稿
- **ハッシュタグ機能**: タグ付けと検索
- **検索機能**: 投稿・ユーザー検索
- **通知機能**: リアルタイム通知
- **DM機能**: ダイレクトメッセージ

### 9.2 技術拡張
- **PWA対応**: オフライン対応
- **プッシュ通知**: ブラウザ通知
- **リアルタイム通信**: WebSocket実装
- **モバイルアプリ**: React Native対応
- **マイクロサービス**: サービス分割

## 10. 制約事項

### 10.1 技術的制約
- **ブラウザ対応**: Chrome、Firefox、Safari、Edge最新版
- **画像ファイルサイズ**: 5MB以下
- **投稿文字数**: 280文字以内
- **同時アップロード**: 1ファイルまで

### 10.2 運用制約
- **データベースバックアップ**: 手動設定必要
- **ログローテーション**: 手動設定必要
- **セキュリティアップデート**: 定期的な更新必要

---

**作成日**: 2024年12月
**バージョン**: 2.0
**作成者**: 開発チーム
**最終更新**: 2024年12月 